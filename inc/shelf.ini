shelf_home  ()
{
    : local use prefers PUSHD
    ${*:-pushd} $HOME/git/shelf/inc;
}
shelf_cat () {
    function _swhf_cat
    {
    set $(dirname $1) $(basename $1)
    report_notdirectory $1 && return 1
    pushd $1 > /dev/null
    report_notfile $2 && return 2
    trace_call $* 
    printf "# [[file:%s/%s]]\n" $PWD $2
    cat $2
    popd  > /dev/null
    }
    foreach _swhf_cat $*
}
shelf_write () 
{
    function _l_s_write
    {
    	local file=$(which shelflib);
	[[ -f $file ]] || {
	   echo TOUCH a file on your PATH named "shelflib"
	   return
	}
        shelf_home 
            shelf_cat *.fam  util.all shelf.ini > $file
            chmod +x $file;
            source $file;
        popd
     }
     _l_s_write
     unset shelf_cat  _l_s_write
     comment test shelf_cat after shelf_init
}
shelf_init ()
{
     : FAM cannot trace, 
     fam_init
     trace_init
     : but now we can?
     report_init
     shd_init
}
shelf_init 1>&2
